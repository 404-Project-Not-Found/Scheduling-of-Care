<!-- I'm using template i found in github in the following link: https://github.com/othneildrew/Best-README-Template/edit/main/README.md -->

<div align="center">
    <a href="https://github.com/404-Project-Not-Found/Schedule-of-Care-Program">
        <img src="images/logo-name.png" alt="Logo" width="3" height="125">
    </a>
    <p align="left">
        <i>Scheduling of Care</i> is a tool to assist the people who care and manage the care of people with special needs (PWSN). It places responsibilities, updates and schedules into one application, making it easier to ensure care items are documented and responsive to change.
    </p>
</div>

<!-- TABLE OF CONTENTS -->

<Strong>Table of Contents</strong>

<ol>
<li>
<a href="#about-the-project">About the Project</a>
<ul>
<li><a href="#features">Features</a></li>
<li><a href="#tech-stack-and-resources">Tech Stack and Resources</a></li>
</ul>
</li>
<li>
<a href=#getting-started>Getting Started</a>
<ul>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#mongodb-setup-guide">Mongodb Setup Guide</a></li>
<li><a href="#local-development-setup">Local Development Setup</a></li>
</ul>
</li>
<li><a href="#deployment">Deployment</a></li>
<li><a href=#testing>Testing</a></li>
<li><a href="#team-members">Team Members</a></li>
<li><a href="#license">License</a></li>
<li><a href="#links">Links</a></li>
<li><a href="#frontend-demo-mock-mode">Frontend Demo (Mock Mode)</a></li>
</ol>

<!-- Content -->

<h2 id="about-the-project"> About the Project</h2>

<h3 id="features">Features</h3>

<h4><strong>Roles and Permissions for Users</strong></h4>
    <ul>
        <li>The app supports three different user roles: Family/Power of Attorney (POA), Management and Carer. Each role have different permissions on what they can view and edit.</li>
        <li>A <i>Family/POA</i> user has the highest authority and is responsible for providing their PWSN access privileges to service providers caring for that PWSN.</li>
        <li>A <i>Management</i> user has control over the staff registered to their staff list and can oversee all care item completions, budget and transaction reports and family requests.</li>
        <li>A <i>Carer</i> user will need to seek permission from the management staff to join the service providers list in order to view client care schedules and reports to complete care items and document submissions.</li>
    </ul>

<h4><strong>Sign Up and Log In</strong></h4>
    <ul>
        <li>To Sign Up, each user will need to select their role between Family/POA, Management or Carer and fill in their information.</li> 
        <li>For a <i>Management</i> user whose <strong>service provider is new to the application</strong>, they'll need to add their service provider's name when signing up. This will register both the user and their service provider to the application.</li>
         <li>For a <i>Management</i> user whose <strong>service provider is already registered</strong> to the application, they'll need to enter a invite code when signing up. This invite code can be generated by a <i>Management</i> user whose account is already linked to the service provider.</li>
        <li>For a <i>Carer</i>, they'll need to request an invite code from their managament staff in order to create an account.</li>
        <li>All users will need to input their full name, email address, phone number and create and confirm their password when signing up.</li>
        <li>After signing up, the user can simply login into the application via their email and password.</li>
        <li>Forgotten passwords can be reset via a reset password link emailed to the user's email account.</li>
    </ul>

<h4><strong>Care Items and Calendar</strong></h4>
    <ul>
        <li>Management can add, edit and remove care items for a client and choose the frequency, status, and category.</li>
        <li>Family/POA can request for care items to be revised or removed.</li>
        <li>For repeated care items, the application will automatically repeat care item reminder in calendar based on information inputted by Management.</li>
        <li>Carers can view care items, mark them as done, add comments related to the care item and upload files as evidence that the care item has been completed.</li>
        <li>Management would need to validate the care item based on the evidence uploaded to verify whether the care item has been completed appropriately.</li>
    </ul>

<h4><strong>Budgeting and Finance</strong></h4>
    <ul>    
        <li>Management can set budget for the year and split it into categories. The budget can only be edited by Management but Family/POA can make requests.</li>
        <li>When a care item that requires finance is completed, Carers can upload receipts which would deduct from the budget based on how much is spent.</li>
        <li>When only a certain amount is left for a category, a notification will appear on the app to warn users.</li>
    </ul>

<h3 id="tech-stack-and-resources">Tech Stack and Resources</h3>

<ul>
    <li><strong>Framework</strong>: <a href="https://nextjs.org/docs">Next.Js</a></li>
    <li><strong>Frontend</strong>: <a href="https://react.dev/learn">React</a></li>
    <li><strong>Backend</strong>: <a href="https://www.typescriptlang.org/docs/">Typescript</a>, <a href="https://www.mongodb.com/">Mongodb</a>, <a href="https://next-auth.js.org/getting-started/introduction">Auth.js(NextAuth)</a>, <a href="https://resend.com/">Resend</a></li>
    <li><strong>Testing</strong>: <a href="https://jestjs.io/docs/getting-started">Jest</a></li></li>
    <li><strong>CI</strong>:<a href="https://docs.github.com/en/actions/get-started/understand-github-actions"> Github Actions</a></li>
    <li><strong>Deployment</strong>: <a href="https://vercel.com/resources">Vercel</a></li>
</ul>

<h2 id="getting-started">Getting Started</h2>

<h3 id="prerequisites">Prerequisites</h3>

Before running the app, ensure that you have the following:

<ul>
    <li>Node.js</li>
    <li>Package manager - npm.</li>
    <li><a href="https://www.mongodb.com/cloud/atlas/register">MongoDB Atlas account</a> (or local MongoDB).</li>
    <li><a href="https://vercel.com/signup">Vercel Account</a> (if going to deploy, no installation required locally but need to create an account).</li>
     <li><a href="https://resend.com/signup">Resend account</a> (required for testing and custom domain verification is also needed for production).</li>
</ul>

<h3 id="mongodb-setup-guide">MongoDB Setup Guide</h3>
<ol>
    <li><strong>Create an Account</strong>
        <ol type="a">
            <li> Go to <a href="https://www.mongodb.com/cloud/atlas/register">MongoDB Atlas account</a> to create an account and sign up.</li>
        </ol>
    </li>
    <li><strong>Create a Cluster</strong>
        <ol type="a">
            <li> Choose the free options or if you wish to add more storage, choose the payment option.</li>
            <li> Pick the nearest region to where you are.</li>
            <li> Create a cluster ‚Äî for team projects, you can share a cluster but use separate databases for each environment or developer.</li>
        </ol>
    </li>
    <li><strong>Configure Access</strong>
        <ol type="a">
            <li>Add database user (username and password).</li>
            <li> Add IP address or set to 0.0.0.0/0 (<b>Not ideal for production</b>, use only for testing).</li>
        </ol>
    </li>
    <li><strong>Get Connection String</strong>
        <ol type="a">
            <li> Click connect ‚Üí choose driver and Node.js from dropdown ‚Üí Use username and password from when you created your database.</li>
            <li> Get the URI and place this in .env.local in your environment as the following:</li>
            <pre><code>MONGODB_URI="mongodb+srv://<user>:<pass>@<cluster>.mongodb.net/<db>?retryWrites=true&w=majority"</code></pre>
        </ol>
    </li>
    <li><strong>Set up mongodb.ts</strong>
        <ol type="a">
            <li> Example setup connecting via Mongoose:</li>
            <pre><code>import mongoose from "mongoose";

const MONGODB_URI = process.env.MONGODB_URI as string;

if (!MONGODB_URI) throw new Error("Please add uri into .env.local");

declare global {
var \_mongooseConnection: { isConnected?: boolean } | undefined;
}

export const connectDB = async () => {
if (global.\_mongooseConnection?.isConnected) return mongoose.connection;

try {
await mongoose.connect(MONGODB_URI);
global.\_mongooseConnection = { isConnected: true };
console.log("MongoDB is connected via Mongoose");
return mongoose.connection;
} catch (err) {
console.error("MongoDB connection error:", err);
throw err;
}
};</code></pre>

</ol>

<h3>Set up NextAuth</h3>
<ol>
    <li>Generate a secret key, in your terminal run the following command:</li>
    <pre><code>openssl rand -base64 32</code></pre>
    <p>it will output your <code>AUTH_SECRET</code>:</p>
    <pre><code>[your_auth_secret]</code></pre>
</ol>

<h3 id="local-development-setup">Local Development Setup</h3>
<ol>
    <li>Clone this repository</li>
    <pre><code>git clone https://github.com/404-Project-Not-Found/Schedule-of-Care-Program.git
cd Schedule-of-Care-Program</code></pre>
    <li>Install dependencies</li>
    <pre><code>npm install</code></pre>
    <li>Set up environment variables
     <ol type="a">
            <li> In your project root, create a <code>.env.local</code> file.</li>
            <li>Add your MongoDB URI, Auth_Secret, the local production URL, Resend API key and base URL:</li>
            <pre><code>MONGODB_URI=[your-mongodb-connection-string]
AUTH_SECRET=[your_auth_secret]
NEXTAUTH_URL=http://localhost:3000
RESEND_API_KEY=[your-resend-api-key]
NEXT_PUBLIC_APP_URI=http://localhost:3000</code></pre>
            <li>Run the development server</li>
            <pre><code>npm run dev</code></pre>
        </ol>
    </li>

</ol>
Then open <a href="http://localhost:3000">http://localhost:3000</a> on your browser to view the app

</br>

<h2 id="deployment">Deployment</h2>

For deployment, do the following:

<ol>
    <li>Push code to GitHub.</li>
    <li>Connect the repository to Vercel.</li>
    <li>Add the environment variables in Vercel under Project Settings ‚Üí Environment Variables:</li>
    <pre><code>MONGODB_URI=[your-mongodb-connection-string]
AUTH_SECRET=[your-auth-secret>]
NEXTAUTH_URL=[your-production-url]
RESEND_API_KEY=[your-resend-api-key]
NEXT_PUBLIC_APP_URI=[your-production-url]</code></pre> 
    <li>Vercel will then auto-build and deploy each push to the default branch.</li></ol>
For more information, you can read the <a href="https://nextjs.org/docs/app/getting-started/deploying">Next.js Deployment Documentation.</a>

</br>

<h2 id="testing">Testing</h2>
To run our unit testing, run the following:
 <pre><code># run all test
npm run test
# run a specific test
npx jest tests/models/Users.test.ts</code></pre>

<h3>Test Coverage</h3>
<ul>
  <li><code>/tests/models/Budget.test.ts</code></li>
  <li><code>/tests/models/CareItem.test.ts</code></li>
  <li><code>/tests/models/Category.test.ts</code></li>
  <li><code>/tests/models/Client.test.ts</code></li>
  <li><code>/tests/models/FamilyRequest.test.ts</code></li>
  <li><code>/tests/models/Occurrence.test.ts</code></li>
  <li><code>/tests/models/Organisation.test.ts</code></li>
  <li><code>/tests/models/PasswordResetToken.test.ts</code></li>
  <li><code>/tests/models/Shift.test.ts</code></li>
  <li><code>/tests/models/Transaction.test.ts</code></li>
  <li><code>/tests/models/User.test.ts</code></li>
</ul>

</br>

<h2 id="team-members">Team Members</h2>

<a href="https://github.com/dpalexander21">
<img style="border-radius: 50%;" src="https://avatars.githubusercontent.com/u/201690137?v=4" width="50px">
</a>
<a href="https://github.com/seekz39">
<img style="border-radius: 50%;" src="https://avatars.githubusercontent.com/u/224220903?v=4" width="50px">
</a>
<a href="https://github.com/vanessateoooooo">
<img style="border-radius: 50%;" src="https://avatars.githubusercontent.com/u/202028025?v=4" width="50px">
</a>
<a href="https://github.com/devniwij">
<img style="border-radius: 50%;" src="https://avatars.githubusercontent.com/u/201507161?v=4" width="50px">
</a>
<a href="https://github.com/zriz15">
<img style="border-radius: 50%;" src="https://avatars.githubusercontent.com/u/136954712?v=4" width="50px">
</a>

</br>

<h2 id="license">License</h2>

Scheduling for Care is licensed under the MIT license. See <a href="LICENSE">LICENSE</a> for details.
</br>

<h2 id="links">Links</h2>

<ul>
    <li><a href="https://scheduling-of-care-web-app.vercel.app/ ">Application</a></li>
    <li><a href="https://team404projectnotfound.atlassian.net/wiki/spaces/09ace67881cc434bab85e12ce5e340a7/overview">Documentation: Confluence</a> -- Requires permission to view</li>
    <li><a href="https://github.com/404-Project-Not-Found/Schedule-of-Care-Program">Source Code</a></li>
    <li><a href="https://team404projectnotfound.atlassian.net/wiki/spaces/09ace67881cc434bab85e12ce5e340a7/pages/100106349/Handover+Documents?atlOrigin=eyJpIjoiZjAzMDBmM2EwODAwNDAyOGJlNzExMmE4Y2FiNTQ4NjMiLCJwIjoiYyJ9 ">Handover Document</a></li>
</ul>

</br>

<h2 id="frontend-demo-mock-mode">Frontend Demo (Mock Mode)</h2>

> Quick guide for <strong>local frontend demo</strong> using mock data & mock login. Includes three demo accounts, `.env.local` setup, where to put the mock API and common gotchas.

<h3>üë§ Demo Accounts (Mock Login)</h3>

On the login page `/`, use any set below. After login, role is stored in browser storage and controls routing & permissions.

| Role       | Email                  | Password     |
| ---------- | ---------------------- | ------------ |
| Family     | `family@email.com`     | `family`     |
| Carer      | `carer@email.com`      | `carer`      |
| Management | `management@email.com` | `management` |

\* Redirects are based on the current mock logic. If you change your routes, also update the logic in the login page.

<h3>‚öôÔ∏è Enable Mock Mode</h3>

Create <strong>`.env.local`</strong> in the project root with:

```ini
NEXT_PUBLIC_ENABLE_MOCK=1
```

What this does:

- Sets the app to <strong>frontend-only mock mode</strong>: login & data are handled on the client and no backend is required.
- Care items are stored in `localStorage["tasks"]`; a demo seed is written on the first run.
- Viewer role is stored in:
  - `sessionStorage["mockRole"]` (per-tab, preferred in mock)
  - `localStorage["activeRole"]` (persistent fallback)

<h3>‚ñ∂Ô∏è Run Locally</h3>

```bash
# install dependencies
npm install

# start dev server
npm run dev

# open
http://localhost:3000
```

<h3>üß∞ Where Is the Mock API?</h3>

```
Source files in /src/lib/mock/mockApi.ts which include more details
```

pages import from `@/lib/mock/mockApi`.
